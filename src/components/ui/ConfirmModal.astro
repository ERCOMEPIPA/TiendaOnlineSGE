---
// Modal de confirmación elegante
---

<div id="confirmModal" class="hidden fixed inset-0 z-50 overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
    <!-- Overlay -->
    <div class="fixed inset-0 bg-carbon-900 bg-opacity-75 transition-opacity" id="modalOverlay"></div>

    <!-- Modal Container -->
    <div class="fixed inset-0 z-10 overflow-y-auto">
        <div class="flex min-h-full items-center justify-center p-4 text-center sm:p-0">
            <!-- Modal Panel -->
            <div class="relative transform overflow-hidden rounded-2xl bg-white text-left shadow-2xl transition-all sm:my-8 sm:w-full sm:max-w-lg">
                <!-- Icono y contenido -->
                <div class="bg-white px-6 pt-6 pb-5 sm:p-8">
                    <div class="flex items-start">
                        <!-- Icono de alerta -->
                        <div class="mx-auto flex h-14 w-14 flex-shrink-0 items-center justify-center rounded-full bg-gradient-to-br from-amber-50 to-amber-100 sm:mx-0 sm:h-12 sm:w-12">
                            <svg class="h-7 w-7 text-amber-600" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
                            </svg>
                        </div>
                        <!-- Texto -->
                        <div class="mt-0 ml-4 text-left sm:mt-0">
                            <h3 class="text-xl font-semibold leading-6 text-carbon-900 mb-2" id="modal-title">
                                ¿Estás seguro?
                            </h3>
                            <div class="mt-2">
                                <p class="text-sm text-carbon-600 leading-relaxed" id="modalMessage">
                                    Esta acción no se puede deshacer.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Botones -->
                <div class="bg-carbon-50 px-6 py-4 sm:flex sm:flex-row-reverse sm:px-8 gap-3">
                    <button 
                        type="button" 
                        id="confirmBtn" 
                        class="inline-flex w-full justify-center rounded-lg bg-gradient-to-r from-red-600 to-red-700 px-5 py-3 text-sm font-semibold text-white shadow-sm hover:from-red-700 hover:to-red-800 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all sm:w-auto"
                    >
                        Confirmar
                    </button>
                    <button 
                        type="button" 
                        id="cancelBtn" 
                        class="mt-3 inline-flex w-full justify-center rounded-lg bg-white px-5 py-3 text-sm font-semibold text-carbon-900 shadow-sm ring-1 ring-inset ring-carbon-300 hover:bg-carbon-50 focus:outline-none focus:ring-2 focus:ring-navy-500 transition-all sm:mt-0 sm:w-auto"
                    >
                        Cancelar
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Función global para mostrar el modal de confirmación
    window.showConfirm = function(message: string, title: string = "¿Estás seguro?"): Promise<boolean> {
        return new Promise((resolve) => {
            const modal = document.getElementById('confirmModal');
            const modalTitle = document.getElementById('modal-title');
            const modalMessage = document.getElementById('modalMessage');
            const confirmBtn = document.getElementById('confirmBtn');
            const cancelBtn = document.getElementById('cancelBtn');
            const overlay = document.getElementById('modalOverlay');

            if (!modal || !modalTitle || !modalMessage || !confirmBtn || !cancelBtn || !overlay) {
                resolve(false);
                return;
            }

            // Establecer título y mensaje
            modalTitle.textContent = title;
            modalMessage.textContent = message;

            // Mostrar modal con animación
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.add('opacity-100');
            }, 10);

            // Función para cerrar modal
            const closeModal = (result: boolean) => {
                modal.classList.add('hidden');
                modal.classList.remove('opacity-100');
                resolve(result);
            };

            // Event listeners
            const handleConfirm = () => {
                closeModal(true);
                confirmBtn.removeEventListener('click', handleConfirm);
                cancelBtn.removeEventListener('click', handleCancel);
                overlay.removeEventListener('click', handleCancel);
            };

            const handleCancel = () => {
                closeModal(false);
                confirmBtn.removeEventListener('click', handleConfirm);
                cancelBtn.removeEventListener('click', handleCancel);
                overlay.removeEventListener('click', handleCancel);
            };

            confirmBtn.addEventListener('click', handleConfirm);
            cancelBtn.addEventListener('click', handleCancel);
            overlay.addEventListener('click', handleCancel);

            // Cerrar con tecla Escape
            const handleEscape = (e: KeyboardEvent) => {
                if (e.key === 'Escape') {
                    handleCancel();
                    document.removeEventListener('keydown', handleEscape);
                }
            };
            document.addEventListener('keydown', handleEscape);
        });
    };

    // Declaración de tipo para TypeScript
    declare global {
        interface Window {
            showConfirm: (message: string, title?: string) => Promise<boolean>;
        }
    }
</script>

<style>
    #confirmModal {
        transition: opacity 0.2s ease-in-out;
    }
</style>
