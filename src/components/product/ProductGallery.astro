---
interface Props {
    images: string[];
    productName: string;
}

const { images, productName } = Astro.props;
const hasImages = images && images.length > 0;
---

<div class="product-gallery">
    {/* Main Image */}
    <div class="aspect-square bg-carbon-100 rounded-xl overflow-hidden mb-4">
        {
            hasImages ? (
                <img
                    id="main-image"
                    src={images[0]}
                    alt={productName}
                    class="w-full h-full object-cover"
                />
            ) : (
                <div class="w-full h-full flex items-center justify-center text-carbon-300">
                    <svg
                        class="w-24 h-24"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="1.5"
                            d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                        />
                    </svg>
                </div>
            )
        }
    </div>

    {/* Thumbnails */}
    {
        hasImages && images.length > 1 && (
            <div class="flex gap-3 overflow-x-auto pb-2">
                {images.map((image, index) => (
                    <button
                        data-index={index}
                        class={`thumbnail flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden 
                  border-2 transition-all duration-200 
                  ${index === 0 ? "border-navy-800" : "border-transparent hover:border-navy-400"}`}
                    >
                        <img
                            src={image}
                            alt={`${productName} - Vista ${index + 1}`}
                            class="w-full h-full object-cover"
                        />
                    </button>
                ))}
            </div>
        )
    }
</div>

<script define:vars={{ images }}>
    // Image gallery interaction
    const mainImage = document.getElementById("main-image");
    const thumbnails = document.querySelectorAll(".thumbnail");

    thumbnails.forEach((thumb, index) => {
        thumb.addEventListener("click", () => {
            // Update main image
            if (mainImage) {
                mainImage.src = images[index];
                mainImage.classList.add("animate-fade-in");
                setTimeout(
                    () => mainImage.classList.remove("animate-fade-in"),
                    200,
                );
            }

            // Update active thumbnail
            thumbnails.forEach((t, i) => {
                if (i === index) {
                    t.classList.add("border-navy-800");
                    t.classList.remove("border-transparent");
                } else {
                    t.classList.remove("border-navy-800");
                    t.classList.add("border-transparent");
                }
            });
        });
    });
</script>
